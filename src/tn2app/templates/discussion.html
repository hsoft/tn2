{% extends 'base.html' %}
{% load comments %}

{% block main_contents %}
<p>
    <a href="{% url 'homepage' %}">Accueil</a>&nbsp;&gt;&nbsp;
    <a href="{% url 'discussion_groups' %}">Groupes</a>&nbsp;&gt;&nbsp;
    <a href="{{ discussion.group.get_absolute_url }}">{{ discussion.group.title }}</a>
</p>
<h1>{{ discussion.title }}</h1>
<p>
    <em>Par <a href="{{ discussion.author.profile.get_absolute_url }}">{{ discussion.author }}</a> le {{ discussion.creation_time }}</em>
    {% if discussion.author == user %}
    <a class="button" href="{% url 'discussion_edit' group_slug=discussion.group.slug discussion_slug=discussion.slug %}">Modifier</a>
    {% endif %}
</p>
{{ discussion.content|safe }}

{% render_comment_list for discussion %}

{% if user.is_authenticated %}
    <h2>RÃ©pondre</h2>
    {% get_comment_form for discussion as form %}
    <form action="{% comment_form_target %}" method="POST">
    {% csrf_token %}
    {{ form.comment }}
    {{ form.honeypot }}
    {{ form.content_type }}
    {{ form.object_pk }}
    {{ form.timestamp }}
    {{ form.security_hash }}
    <input type="hidden" name="next" value="{{ discussion.get_absolute_url }}" />
    <p>
        <input class="button" type="submit" value="Commenter" />
    </p>
    </form>
{% endif %}
{% endblock %}

{% block bottom_js %}
{% include 'include/ckjs.html' %}
{% endblock %}
